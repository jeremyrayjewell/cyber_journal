# Write-up: Natas 19 → 20  
**Date:** 2026-01-01  

## Obfuscated password (ROT13)  
`c5zPiC7TF2X6Ozg3tduZ2Sp1N5G8ZIlj`

---

## OBJECTIVE

> The objective of this level was to obtain the password for natas20 by exploiting weaknesses in how the application generated and validated session identifiers.

---

## PURPOSE

This challenge demonstrates how predictable session identifier construction can completely undermine authentication controls.
Unlike the previous level, session IDs were no longer simple integers, but were instead derived from a deterministic encoding of user-controlled values.

The application constructed session identifiers by concatenating a numeric value with a static string (`"-admin"`) and encoding the result in hexadecimal. Because this process was deterministic and lacked randomness, valid administrative sessions could be generated by reproducing the encoding logic client-side.

---

## SOLUTION

By inspecting the behavior of the application, it became clear that valid administrator sessions followed the pattern `<integer>-admin  →  hex-encoded`.  To exploit this, a script was written to:
- Generate candidate session identifiers in the format `<id>-admin`
- Encode each value as hexadecimal
- Submit each value as the PHPSESSID cookie
- Inspect server responses for indicators of authenticated access
Once a matching session was discovered, the application returned the password for the next level, confirming successful privilege escalation. This approach required no credential brute-forcing and relied entirely on predictable session construction.

Rather than writing a new exploit, [the same session enumeration script from the previous level](https://github.com/jeremyrayjewell/cyber_journal/tree/main/experiments/session_enumerator) was reused with a small modification to the session encoding logic.
Only the session format changed; the enumeration strategy remained identical. The following command was used to identify the valid administrator session:
```
python session_enumerator.py \
  --url http://natas19.natas.labs.overthewire.org \
  --user natas19 \
  --password <REDACTED> \
  --mode hex-admin
```
This confirmed that the application relied on a predictable, hex-encoded session identifier, allowing full authentication bypass without credential brute-forcing.

---

## TAKEAWAYS

- Encoding is not a security control; it provides no protection against inference.
- Session identifiers must be generated using cryptographically secure randomness.
- Predictable session schemes allow full authentication bypass.
- Even minor deviations in session handling logic can lead to complete compromise.
___

Writeup author: **Jeremy Ray Jewell**  
[GitHub](https://github.com/jeremyrayjewell)  
[LinkedIn](https://www.linkedin.com/in/jeremyrayjewell)
